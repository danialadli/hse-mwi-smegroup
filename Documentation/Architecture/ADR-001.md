# ADR-001: Architectural Recovery Strategy and Current System State

* **Author:** Danial Adli @danialadli
* **Context:** Legacy System Reengineering

## Context
The `hse-mwi` (Mental Wellness Index) legacy system currently lacks architectural documentation. The application logic is distributed across standard R Shiny files (`ui.R`, `server.R`, `global.R`) and external data processing scripts.

Key issues identified during legacy analysis:
1.  **Lack of Visibility:** There are no diagrams to visualize how data flows from raw sources to the final visualization.
2.  **Implicit Architecture:** The system structure (Monolithic R Shiny App) is not explicitly defined, leading to confusion about where business logic resides versus presentation logic.
3.  **Data Coupling:** It is unclear to new developers that the system relies on a flat-file architecture (CSV/RDS) rather than a relational database.

## Decision
In order to document the architecture of the system, I have performed an **Architectural Recovery** using the **C4 Model** (Context, Containers, Components).

There are three levels of documentation included:
* **Level 1 (System Context Diagram):** To define the system boundaries and external data dependencies (Census/CDC).
* **Level 2 (Container Diagram):** To explicitly map the "File-Based" architecture and the separation between offline data processing and the live application.
* **Level 3 (Component Diagram):** To map the internal structure of the Shiny Application, specifically focusing on the relationship between the `Global Loader`, `UI Layer`, and `Server Logic`.

## Pros and Cons

### Positive Impacts
* **Reduced Cognitive Load:** Developers can now understand the "Big Picture" and the "Internal Logic" without reading every line of source code.
* **Refactoring Roadmap:** The Component Diagram visually exposes the high coupling in `server.R`, serving as a baseline for future modularization (e.g., moving logic into separate `R/` modules).
* **Data Flow Clarity:** Explicitly documenting the file-based nature of the app prevents confusion regarding database connections.

### Negative Consequences / Trade-offs
* **Maintenance Overhead:** Unlike auto-generated diagrams, these C4 diagrams are static artifacts. They must be manually updated if the high-level structure of `app.R` or the data ingestion pipeline changes significantly.
